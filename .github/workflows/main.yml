name: tests

on: [push]

jobs:
  build:
    runs-on: ubuntu-18.04
    steps:

    - name: checkout repository
      uses: actions/checkout@master

    - name: create symlink
      run: ln -s $(pwd) ~/sportmonks

    - name: install APT packages
      run: |
        sudo apt-get install python3-venv
        sudo apt-get install python3-pip

    - name: setup virtual environment
      run: bash setup-venv.sh

    - name: run static code checks
      run: bash ~/sportmonks/run-static-code-checks.sh

    - name: run unit tests
      run: bash ~/sportmonks/run-unit-tests.sh

    - name: run integration tests
      env:
        SPORTMONKS_API_KEY: ${{ secrets.SPORTMONKS_API_KEY }}
      run: bash ~/sportmonks/run-integration-tests.sh
